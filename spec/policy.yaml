# Purpose: Define scanner policy limits and banned patterns for PromptCalc artifacts.
# Persists: None.
# Security Risks: Controls rejection criteria for untrusted, AI-generated artifacts.
specVersion: "1.1"
maxArtifactBytes: 200000
requiredBannerText: "Generated calculator (offline). Do not enter passwords."
requiredReadyMarker: "promptcalc-ready"
requiredCspDirectives:
  - "default-src 'none'"
  - "connect-src 'none'"
  - "img-src 'none'"
  - "script-src 'unsafe-inline'"
  - "style-src 'unsafe-inline'"
  - "base-uri 'none'"
  - "form-action 'none'"
  - "object-src 'none'"
bannedPatterns:
  - id: DISALLOWED_NETWORK
    patterns:
      - "fetch("
      - "XMLHttpRequest"
      - "WebSocket"
      - "EventSource"
      - "sendBeacon"
  - id: DISALLOWED_EVAL
    patterns:
      - "eval("
      - "new Function"
      - "Function("
      - "import("
  - id: DISALLOWED_EXTERNAL_DEPENDENCY
    patterns:
      - "<script src="
      - "<link rel="
      - "@import"
      - "url("
  - id: DISALLOWED_CREDENTIAL_UI
    patterns:
      - "type=\"password\""
      - "type='password'"
  - id: DISALLOWED_NETWORK
    patterns:
      - "window.open"
      - "top.location"
      - "parent.location"
      - "document.location="
bannedTags:
  - id: DISALLOWED_EXTERNAL_DEPENDENCY
    tags:
      - "iframe"
      - "object"
      - "embed"
      - "base"
